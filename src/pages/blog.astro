---
import BaseLayout from '../layouts/BaseLayout.astro';
import { SITE_TITLE } from '../config';

// Use Astro.glob() to fetch all posts, and then sort them by date.
const posts = (await Astro.glob('./blog/*.{md,mdx}')).sort(
	(a, b) => new Date(b.frontmatter.pubDate).valueOf() - new Date(a.frontmatter.pubDate).valueOf()
);

const title = 'Blog';
const description = 'Latest articles';
const permalink = `${Astro.site.href}blog`;
---

<BaseLayout title={title} description={description} permalink={permalink}>
    <main>
        <h1>Blog posts - {SITE_TITLE}</h1>

        <ul>
            {
                posts.map((post) => (
                    <li>
                        <a href={post.url}>{post.frontmatter.title}</a>

                        <time datetime={post.frontmatter.pubDate}>
                            {new Date(post.frontmatter.pubDate).toLocaleDateString('en-us', {
                                year: 'numeric',
                                month: 'short',
                                day: 'numeric',
                            })}
                        </time>
                    </li>
                ))
            }
        </ul>
    </main>
</BaseLayout>

<style>
ul a {
    color: #333;
}
ul a:hover {
    color: deepskyblue;
}
</style>